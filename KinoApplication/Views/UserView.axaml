<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="clr-namespace:KinoApplication.ViewModels;assembly=KinoApplication"
    xmlns:dgrid="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.DataGrid"
    x:Class="KinoApplication.Views.UserView"
    x:DataType="vm:UserViewModel"
    x:CompileBindings="True">

	<UserControl.DataContext>
		<vm:UserViewModel/>
	</UserControl.DataContext>

	<StackPanel Margin="20" Spacing="10" HorizontalAlignment="Center">

		<!-- 1) Repertuar -->
		<TextBlock Text="Repertuar" FontSize="24" HorizontalAlignment="Center"/>
		<Border BorderBrush="Gray"
				BorderThickness="1"
				Padding="10"
				Margin="0,0,0,10"
				Width="600"
				Height="350">
			<StackPanel Spacing="10">
				<dgrid:DataGrid
					ItemsSource="{Binding Seanse}"
					AutoGenerateColumns="False"
					IsReadOnly="True"
					SelectionMode="Single"
					SelectedItem="{Binding WybranySeans}"
					Height="220">
					<dgrid:DataGrid.Columns>
						<dgrid:DataGridTextColumn Header="Film"  Binding="{Binding Film.Title}"/>
						<dgrid:DataGridTextColumn Header="Sala"  Binding="{Binding Sala.Name}"/>
						<dgrid:DataGridTextColumn Header="Data"
						   Binding="{Binding Data, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}"/>
						<dgrid:DataGridTextColumn Header="Cena"
						   Binding="{Binding Film.Price, StringFormat='${0:0.00}'}"/>
					</dgrid:DataGrid.Columns>
				</dgrid:DataGrid>

				<Button x:Name="WybierzSeansBtn"
						Content="Wybierz seans"
						IsEnabled="{Binding WybranySeans, Converter={StaticResource NotNullToBoolConverter}}"
						HorizontalAlignment="Right"/>
			</StackPanel>
		</Border>

		<!-- 2) Panel użytkownika -->
		<TextBlock Text="Panel użytkownika" FontSize="24" HorizontalAlignment="Center"/>
		<Border BorderBrush="Gray"
				BorderThickness="1"
				Padding="10"
				Margin="0,0,0,10"
				Width="600"
				Height="350">
			<StackPanel Spacing="10">
				<!-- Pasek z nazwą i przyciskami -->
				<StackPanel Orientation="Horizontal"
							Spacing="10"
							VerticalAlignment="Center">
					<TextBlock Text="{Binding CurrentUser, StringFormat=Zalogowany\: {0}}"
							   FontWeight="Bold"
							   VerticalAlignment="Center"/>
					<Button Content="Moje rezerwacje"
							x:Name="ShowReservationsBtn"/>
					<Button Content="Moje konto"/>
					<Button Content="Wyloguj"
							Background="Red"
							Foreground="White"/>
				</StackPanel>

				<!-- Panel rezerwacji -->
				<Border x:Name="ReservationsPanel"
						BorderBrush="Gray"
						BorderThickness="1"
						Padding="10"
						Margin="0,5,0,0"
						IsVisible="False">
					<StackPanel Spacing="6">
						<TextBlock Text="Moje rezerwacje:" FontSize="18"/>
						<dgrid:DataGrid ItemsSource="{Binding Reservations}"
										AutoGenerateColumns="False"
										IsReadOnly="True"
										CanUserResizeColumns="False"
										Height="200">
							<dgrid:DataGrid.Columns>
								<dgrid:DataGridTextColumn Header="Film"    Binding="{Binding FilmTitle}"/>
								<dgrid:DataGridTextColumn Header="Sala"    Binding="{Binding SalaName}"/>
								<dgrid:DataGridTextColumn Header="Data"    Binding="{Binding Data, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}"/>
								<dgrid:DataGridTextColumn Header="Rząd"    Binding="{Binding Row}"/>
								<dgrid:DataGridTextColumn Header="Kolumna" Binding="{Binding Column}"/>
							</dgrid:DataGrid.Columns>
						</dgrid:DataGrid>
					</StackPanel>
				</Border>
			</StackPanel>
		</Border>

	</StackPanel>
</UserControl>
